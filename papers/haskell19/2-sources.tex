\section{Random Testing using Hints}
\label{sec:sources}


Pellentesque dapibus suscipit ligula. Donec posuere augue in quam. Etiam vel
tortor sodales tellus ultricies commodo. Suspendisse potenti. Aenean in sem ac
leo mollis blandit. Donec neque quam, dignissim in, mollis nec, sagittis eu,
wisi. Phasellus lacus. Etiam laoreet quam sed arcu. Phasellus at dui in ligula
mollis ultricies. Integer placerat tristique nisl. Praesent augue. Fusce
commodo. Vestibulum convallis, lorem a tempus semper, dui dui euismod elit,
vitae placerat urna tortor vitae lacus. Nullam libero mauris, consequat quis,
varius et, dictum id, arcu. Mauris mollis tincidunt felis. Aliquam feugiat
tellus ut neque. Nulla facilisis, risus a rhoncus fermentum, tellus tellus
lacinia purus, et dictum nunc justo sit amet elit.

\begin{code}
data Html
  =  Text  String
  |  Sing  String
  |  Tag   String Html
  |  Join  Html Html
\end{code}

A value of type |Html| represents either plain text strings, via the |Text| data
constructor; single and paired HTML tags using the |Sing| and |Tag| data
constructors, respectively; and concatenation of ...

\begin{code}
class Arbitrary (a :: *) where
  arbitrary :: Gen a
\end{code}

\begin{code}
class Arbitrary (a :: *) where
  arbitrary :: Gen a
\end{code}

\begin{code}
instance Arbitrary Html where
  arbitrary = sized gen
    where
      gen 0 = frequency
        [  (2,  Text    <$> arbitrary)
        ,  (1,  Sing    <$> arbitrary) ]
      gen n = frequency
        [  (2,  Text    <$> arbitrary)
        ,  (1,  Sing    <$> arbitrary)
        ,  (4,  Tag     <$> arbitrary  <*> gen (n-1))
        ,  (3,  Join    <$> gen (n-1)  <*> gen (n-1)) ]
\end{code} %$


\begin{code}
br :: Html
br = Sing "br"

bold :: Html -> Html
bold = Tag "b"

list :: [Html] -> Html
list xs = Tag "ul" (foldl1 Join (Tag "li" <$> xs))

(<+>) :: Html -> Html -> Html
(<+>) x y = Join x (Join br y)
\end{code} %$

\begin{code}
simplify :: Html -> Html
simplify (Join (Text t1) (Text t2))
  = Text (t1 ++ t2)
simplify (Join (Join (Text t1) x) y)
  = simplify (Join (Text t1) (simplify (Join x y)))
simplify (Join x y)
  = Join (simplify x) (simplify y)
simplify (Tag t x)
  = Tag t (simplify x)
simplify x = x
\end{code}
